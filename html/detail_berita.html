<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/detail_berita.css">
    <title>Detail Berita - Desa Gunung Halu</title>
</head>
<body>
    
    <nav>
        <div class="navbar">
            <div class="logo">
                <img src="../foto/logo_desa.png" alt="logo kabupaten bandung barat">
                <div class="title">
                    <h1>Desa Gununghalu</h1>
                    <p>Kabupaten Bandung Barat</p>    
                </div>
            </div>
            <ul class="links">
                <li class="nav-links"><a href="index.html">Beranda</a></li>
                <li class="nav-links"><a href="profil.html">Profil Desa</a></li>
                <li class="nav-links active"><a href="berita.html">Berita</a></li>
                <li class="nav-links"><a href="potensi.html">Potensi</a></li>
                <li class="nav-links"><a href="statistik.html">Statistik</a></li>
                <li class="nav-links"><a href="umkm.html">UMKM</a></li>
            </ul>
            <div class="toggle_btn">
                <i class="fa-solid fa-bars"></i>
            </div>
        </div>

        <div class="drop_menu">
            <li><a href="index.html">Beranda</a></li>
            <li><a href="profil.html">Profil Desa</a></li>
            <li><a href="berita.html">Berita</a></li>
            <li><a href="potensi.html">Potensi</a></li>
            <li><a href="statistik.html">Statistik</a></li>
            <li><a href="umkm.html">UMKM</a></li>
        </div>
    </nav>


    <main class="detail-container">
        <article>
            <div class="news-header">
                <h1 id="judulBerita" class="news-title">Memuat Berita...</h1>
                <div class="news-meta">
                    <span id="tanggalBerita"><i class="far fa-calendar-alt"></i> -</span>
                    <span id="penulisBerita"><i class="far fa-user"></i> -</span>
                </div>
            </div>

            <img id="gambarBerita" class="news-featured-image" src="" alt="Gambar Berita" onerror="this.style.display='none'">

            <div id="isiBerita" class="news-content">
                </div>

            <a href="berita.html" class="btn-back">
                <i class="fas fa-arrow-left"></i> Kembali ke Daftar
            </a>
        </article>

        <!-- PENGADUAN -->
        <div class="floating-area">
            <button class="pengaduan-btn" onclick="togglePengaduan()">
                <i class="fa-solid fa-headset"></i> Pengaduan
            </button>
        </div>
    
        <div id="popupPengaduan" class="popup-card">
            <div class="popup-header">
                <h3>Form Pengaduan</h3>
                <span class="close-popup" onclick="togglePengaduan()">&times;</span>
            </div>
            
            <form id="formFloating">
                <div class="form-group-sm">
                    <label>Nama <span class="req">*</span></label>
                    <input type="text" id="popNama" placeholder="Masukkan nama Anda" required>
                </div>
    
                <div class="form-group-sm">
                    <label>Nomor Telepon/WA <span class="req">*</span></label>
                    <input type="number" id="popWa" placeholder="Nomor WA aktif" required>
                </div>
    
                <div class="form-group-sm">
                    <label>Kategori <span class="req">*</span></label>
                    <div class="select-wrap-sm">
                        <select id="popKategori" required>
                            <option value="" disabled selected>Pilih kategori...</option>
                            <option value="Administrasi">Administrasi</option>
                            <option value="Infrastruktur">Infrastruktur</option>
                            <option value="Keamanan">Keamanan</option>
                            <option value="Lainnya">Lainnya</option>
                        </select>
                    </div>
                </div>
    
                <div class="form-group-sm">
                    <label>Pengaduan <span class="req">*</span></label>
                    <textarea id="popPesan" rows="3" placeholder="Tulis aduan Anda..." required></textarea>
                </div>
    
                <div class="form-group-sm">
                    <label>Lampiran Bukti</label>
                    
                    <input type="file" id="popFile" accept="image/*,.pdf" hidden>
                    
                    <label for="popFile" class="custom-file-area">
                        <div class="file-content">
                            <i class="fa-solid fa-cloud-arrow-up"></i>
                            <span id="fileNameDisplay">Klik untuk unggah foto/PDF</span>
                        </div>
                    </label>
                    <small style="color:#888; font-size:0.7rem;">Maksimal ukuran 2MB</small>
                </div>
    
                <button type="submit" class="btn-submit-popup">
                    <i class="fa-regular fa-paper-plane"></i> Kirim
                </button>
            </form>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-container">
    
            <!-- Kolom 1 -->
            <div class="footer-col-1">
                <img src="../foto/logo_desa.png" alt="Logo Kabupaten Bandung Barat" class="footer-logo">
                <p><strong>Pemerintah Desa Gununghalu</strong> <br>                        Gununghalu <br>
                        Kec. Gununghalu <br>
                        Kabupaten Bandung Barat <br>
                        Jawa Barat, 40565 <br>
                    <strong>Kode Wilayah:</strong> 32.17.15.2002</p>
            </div>
    
            <!-- Kolom 2 -->
            <div class="footer-col">
                <h3>Hubungi Kami</h3>
                <p><i class="fas fa-phone"></i> (022) 6950180</p>
                <p><i class="fas fa-envelope"></i> </p>
            </div>
    
            <!-- Kolom 3 -->
            <div class="footer-col">
                <h3>Media Sosial</h3>
                <div class="social-icons">
                    <a href="https://www.instagram.com/desagununghalu?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-x-twitter"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                    <a href="https://www.tiktok.com/@desagununghalu"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>    
        </div>
    
        <div class="footer-bottom">
            Â© 2026 Powered by Gemasains
        </div>
    </footer>

    <script>
        const toggleBtn = document.querySelector('.toggle_btn')
        const toggleBtnIcon = document.querySelector('.toggle_btn i')
        const dropMenu = document.querySelector('.drop_menu')

        toggleBtn.onclick = function () {
            dropMenu.classList.toggle('open')
            const isOpen = dropMenu.classList.contains('open')

            toggleBtnIcon.classList = isOpen
            ? 'fa-solid fa-xmark'
            : 'fa-solid fa-bars'
        }


        // 1. DATABASE BERITA (Sesuaikan ID dengan link di halaman berita.html)
        const databaseBerita = [
            {
                id: 1,
                judul: "Pembangunan Jalan Desa Selesai Tepat Waktu",
                tanggal: "12 Januari 2026",
                penulis: "Admin Desa",
                gambar: "../foto/beranda/berita1.webp", 
                isi: `
                    <p><strong>GUNUNGHALU</strong> - Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
                    
                    <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
                    
                    <p>Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.</p>
                `
            },
            {
                id: 2,
                judul: "Kunjungan Kerja Bupati Bandung Barat",
                tanggal: "15 Januari 2026",
                penulis: "Humas",
                gambar: "../foto/berita_bupati.jpg",
                isi: `
                    <p><strong>GUNUNGHALU</strong> - Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus lacinia odio vitae vestibulum vestibulum. Cras venenatis euismod malesuada. Nulla facilisi. Integer ut magna nec augue finibus tempor sit amet id leo.</p>

                    <p>Suspendisse potenti. Morbi accumsan ipsum velit. Nam nec tellus a odio tincidunt auctor a ornare odio. Sed non mauris vitae erat consequat auctor eu in elit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</p>

                    <p>Mauris in erat justo. Nullam ac urna eu felis dapibus condimentum sit amet a augue. Sed non neque elit. Sed ut imperdiet nisi. Proin condimentum fermentum nunc. Etiam pharetra, erat sed fermentum feugiat, velit mauris egestas quam, ut aliquam massa nisl quis neque.</p>
                `
            },
            {
                id: 3,
                judul: "Panen Raya Kopi Gununghalu Menembus Pasar Ekspor",
                tanggal: "20 Januari 2026",
                penulis: "Kelompok Tani",
                gambar: "../foto/berita_kopi.jpg",
                isi: `
                    <p><strong>GUNUNGHALU</strong> - Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce aliquet, nisl vitae luctus volutpat, dui magna pellentesque ante, at convallis turpis nisl nec diam. Mauris eget nibh at nibh eleifend tincidunt.</p>

                    <p>Curabitur a felis in nunc fringilla tristique. In hac habitasse platea dictumst. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante.</p>
                `
            }
        ];

        // 2. LOGIKA PROGRAM
        document.addEventListener("DOMContentLoaded", function() {
            const urlParams = new URLSearchParams(window.location.search);
            const idBerita = parseInt(urlParams.get('id'));
            const berita = databaseBerita.find(item => item.id === idBerita);

            if (berita) {
                // Tampilkan Data
                document.getElementById('judulBerita').innerText = berita.judul;
                document.getElementById('tanggalBerita').innerHTML = `<i class="far fa-calendar-alt"></i> ${berita.tanggal}`;
                document.getElementById('penulisBerita').innerHTML = `<i class="far fa-user"></i> ${berita.penulis}`;
                document.getElementById('gambarBerita').src = berita.gambar;
                document.getElementById('isiBerita').innerHTML = berita.isi;
                document.title = `${berita.judul} - Desa Gununghalu`;
            } else {
                // Jika ID Salah
                document.querySelector('article').innerHTML = `
                    <div style="text-align:center; padding: 50px;">
                        <h2>Berita Tidak Ditemukan</h2>
                        <p>Silakan kembali ke halaman utama.</p>
                        <br>
                        <a href="berita.html" class="btn-back">Kembali</a>
                    </div>
                `;
            }
        });

        // PENGADUAN
        // 1. Toggle Buka/Tutup Popup
        function togglePengaduan() {
            const popup = document.getElementById('popupPengaduan');
            popup.classList.toggle('active');
        }

        // 2. Logic Handle Tampilan File Upload
        const fileInput = document.getElementById('popFile');
        const fileLabel = document.querySelector('.custom-file-area');
        const fileNameDisplay = document.getElementById('fileNameDisplay');
        const iconDisplay = document.querySelector('.file-content i');

        fileInput.addEventListener('change', function() {
            if (this.files && this.files.length > 0) {
                // Jika ada file dipilih
                const name = this.files[0].name;
                
                // Ubah Tampilan
                fileNameDisplay.textContent = name; // Tampilkan nama file
                fileLabel.classList.add('has-file'); // Ganti warna border jadi hijau
                iconDisplay.className = "fa-solid fa-check-circle"; // Ganti ikon jadi centang
            } else {
                // Jika batal pilih
                fileNameDisplay.textContent = "Klik untuk unggah foto/PDF";
                fileLabel.classList.remove('has-file');
                iconDisplay.className = "fa-solid fa-cloud-arrow-up";
            }
        });

        // 3. Logic Submit Form (Persiapan ke Admin)
        document.getElementById('formFloating').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Ambil Data Input
            const nama = document.getElementById('popNama').value;
            const wa = document.getElementById('popWa').value;
            const kat = document.getElementById('popKategori').value;
            const pesan = document.getElementById('popPesan').value;
            const file = document.getElementById('popFile').files[0]; // Ambil Objek File Asli

            // --- PERSIAPAN UNTUK DIKIRIM KE ADMIN (BACKEND) ---
            // Nanti saat ada backend, kita pakai FormData
            const formData = new FormData();
            formData.append('nama', nama);
            formData.append('whatsapp', wa);
            formData.append('kategori', kat);
            formData.append('pesan', pesan);
            if (file) {
                formData.append('lampiran', file);
            }

            // SIMULASI (Karena Backend belum ada)
            console.log("Data Siap Dikirim ke Admin:", {
                nama: nama,
                wa: wa,
                kategori: kat,
                file: file ? file.name : "Tidak ada file"
            });

            // SEMENTARA: Tetap arahkan ke WA sebagai notifikasi
            // (File tidak bisa ikut ke WA, tapi user Admin tau ada laporan masuk)
            alert("Laporan berhasil dibuat! Data file sudah siap diproses sistem (Simulasi). Sekarang akan diarahkan ke WA untuk notifikasi cepat.");
            
            const nomorAdmin = "6281234567890"; 
            const textWA = `*NOTIFIKASI LAPORAN BARU*%0A` +
                           `User: ${nama}%0A` +
                           `Kategori: ${kat}%0A` +
                           `Pesan: ${pesan}%0A` +
                           `(File lampiran tersimpan di Dashboard Admin)`;

            window.open(`https://wa.me/${nomorAdmin}?text=${textWA}`, '_blank');
            
            // Reset Form & Tutup
            document.getElementById('formFloating').reset();
            togglePengaduan();
        });
    </script>
</body>
</html>